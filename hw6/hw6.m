%% Control Systems HW6 Problem 1
K1 = 100;   M1 = 1;   B1 = 2;

A1 =   [0,  0,  0,  1,  0,  0;...
        0,  0,  0,  0,  1,  0;...
        0,  0,  0,  0,  0,  1;...
        -2*K1/M1,   K1/M1,  0,  -2*B1/M1,   0,  B1/M1;...
        K1/M1,  -2*K1/M1,   K1/M1,  0,  0,  0;...
        0,  K1/M1,  -K1/M1, B1/M1, 0,  -B1/M1;];
B1 =   [0;  0;  0;  0;  0;  1/M1];
C1 =   [0,  0,  1,  0,  0,  0];
D1 =   [0];

G1 = ss(A1,B1,C1,D1);
tf(G1)
zpk(G1)

t1 = 0:0.01:20;
y1 = step(G1,t1);
plot(t1, y1);
xlabel('Time (seconds)');
ylabel('Gain');

%% Control Systems HW6 Problem 2

K2 = 100;   M2 = 1;   B2 = 2;

A2 =   [0,  0,  0,  0,  1,  0,  0,  0;  ...
        0,  0,  0,  0,  0,  1,  0,  0;  ...
        0,  0,  0,  0,  0,  0,  1,  0;  ...
        0,  0,  0,  0,  0,  0,  0,  1;  ...
        -2*K2/M2,   K2/M2,  0,  0,  -2*B2/M2, B2/M2,    0,  0;  ...
        K2/M2,  -2*K2/M2,   K2/M2,  0,  B2/M2, -2*B2/M2,    B2/M2,  0;  ...
        0,  K2/M2,  -2*K2/M2,   K2/M2,  0,  B2/M2,  -2*B2/M2,   B2/M2;  ...
        0,  0,  K2/M2,  -K2/M2, 0,  0,  -B2/M2, B2/M2]
B2 =   [0;  0;  0;  0;  0;  0;  0;  1/M2];
C2 =   [0, 0, 0, 1, 0, 0, 0, 0];
D2 =   [0];
G2 = ss(A2,B2,C2,D2);
tf(G2)
zpk(G2)

t2 = 0:0.01:100;
y2 = step(G2,t2);
figure;
plot(t2, abs(y2));
xlabel('Time (seconds)');
ylabel('Gain');

%% Control Systems HW6 Problem 3

K3 = 5; J3 = 2;

A3 =   [0,  0,  0,  1,  0,  0;  ...
        0,  0,  0,  0,  1,  0;  ...
        0,  0,  0,  0,  0,  1;  ...
       -5^4*K3/(J3*5^4),   5^4*K3/(J3*5^4),    0,  0,  0,  0;  ...
        (5^4*K3) /(J3*5^2),  -(K3*5^4 + 5^2*K3)/(J3*5^2),    K3*5^2/(J3*5^2),    0,  0,  0;  ...
        0,  5^2*K3/(J3),    -(5^2*K3 + K3)/(J3),    0,  0,  0];
B3 =   [0;  0;  0;  1/(5^4*J3);  0;  0];
C3 =   [0, 0, 1, 0, 0, 0];
D3 =   [0];
G3 = ss(A3,B3,C3,D3);
tf(G3)
zpk(G3)

%% Control Systems HW6 Problem 4

G4 = tf([132666],[1 393.646 79.8463 39401.9])

t4 = 0:0.1:100;
y4 = step(G4,t4);
figure;
plot(t4, abs(y4));
xlabel('Time (seconds)');
ylabel('Gain');
